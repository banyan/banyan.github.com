<html>
  <head>
    <meta charset="utf-8" />
    <title>vcr の結果はバージョン管理に含めるべきかどうか - @banyan's blog</title>
    <meta name="author" content="Kohei Hasegawa" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="/stylesheets/main.css" />
    <link
      rel="stylesheet"
      href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/github-gist.min.css"
    />
    <link rel="shortcut icon" href="/images/favicon.ico" />
    <link rel="apple-touch-icon" href="/images/apple-touch-icon.png" />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="/images/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="/images/apple-touch-icon-114x114.png"
    />
    <link
      href="/atom.xml"
      rel="alternate"
      title="@banyan's blog"
      type="application/atom+xml"
    />

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(["_setAccount", "UA-1469541-7"]);
      _gaq.push(["_trackPageview"]);

      (function () {
        var ga = document.createElement("script");
        ga.type = "text/javascript";
        ga.async = true;
        ga.src =
          ("https:" == document.location.protocol
            ? "https://ssl"
            : "http://www") + ".google-analytics.com/ga.js";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>

  <body>
    <main class="content-width">
      <div class="content-padded autopagerize_page_element">
        <div>
          <h1 class="entry-title"><a href="/2013/06/07/1">vcr の結果はバージョン管理に含めるべきかどうか</a></h1>
        </div>

        <div>
          <time>Jun 7th, 2013</time>
        </div>

        <div id="main-content">
          <div class="content">
            <p><a href="https://github.com/vcr/vcr">vcr</a> は便利な gem で、外部の API などと通信するときにレスポンスをキャッシュして、以降はそのキャッシュを利用してテストを書くことができる gem です。
少し癖はありますが基本的には便利で、vcr 自体については <a href="http://railscasts.com/episodes/291-testing-with-vcr?view=comments">railscasts</a> とかに詳しいと思います。</p>
<p>一方で使っていて、確信を持てなかったのが、その vcr を使ったキャッシュををバージョン管理してしまっていいかでした。
自分は含めて使っていましたが、PR の差分も大きくなるし、いつも少し迷ってました。(言語化できない罪悪感があった)</p>
<p>railscasts のコメントの中でメンテナの <a href="https://github.com/myronmarston">Myron Marston</a> さんがこのことについて書いていたのでこれを訳しておこうと思います。</p>
<blockquote>
<p>これはトレードオフの問題で、あなたがどうしたいのかで変わってきます。自分自身の使い方としては、VCR cassets をバージョン管理する傾向が多いです。
その理由は、ある特定のタイミングでどんな HTTP response だったかの歴史を持つことができるのが好きだからです。git bisect をして、テストを通すことも可能です。
もし cassets がコミットされていなければ、そして HTTP response が変わっていたら、古い状態でテストが通った時の commit しかないため大変になるでしょう。</p>
</blockquote>
<blockquote>
<p>一方で cassets をコミットするということは、多くのファイルができるため git リポジトリが膨れ上がります。
またレスポンスを手動で微調整してテストを通すことも簡単になります。
私は cassets (vcr のキャッシュ) をコミットしないことはそれをただキャッシュとして扱うことだと思っていて好ましく思います。(訳が怪しい)</p>
</blockquote>
<blockquote>
<p>最終的にはあなたがどう考えるか次第です - 今ここであげたメリット・デメリットがあなたにとってどちらが大切かということを考えてみてください。</p>
</blockquote>
<blockquote>
<p><a href="http://railscasts.com/episodes/291-testing-with-vcr?view=comments#comment_162799">http://railscasts.com/episodes/291-testing-with-vcr?view=comments#comment_162799</a></p>
</blockquote>
<p>時としてバージョン管理していいかどうか迷うような状況は色々な理由でやってきたりすることはあると思うのですが、こういう指針があるのはありがたいなーと思いました。</p>
<h3 id="updated">Updated.</h3>
<p>railcasts の Ryan さんにこのコメントの部分だけ訳していいですか？って聞いたら、いいよと言ってくれました。</p>
<blockquote class="twitter-tweet"><p>@<a href="https://twitter.com/banyan">banyan</a> that’s fine with me. Thanks for translating.</p>&mdash; Ryan Bates (@rbates) <a href="https://twitter.com/rbates/status/342707440959225856">June 6, 2013</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

          </div>
        </div>

        <div>
          <div class="pagination">
            
            <a href="/2013/06/06/1" rel="next">« earlier</a>
             
            <a href="/2013/07/09/1">later »</a>
            
          </div>
        </div>

        <div class="autopagerize_insert_before"></div>
      </div>
    </main>
  </body>
</html>
